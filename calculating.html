<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Icon stuff -->
    <link rel="shortcut icon" href="./img/icons/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="./img/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./img/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./img/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./img/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="./img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="./img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./img/icons/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" href="./img/icons/favicon-196x196.png" sizes="196x196">
    <link rel="icon" type="image/png" href="./img/icons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="./img/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="./img/icons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="./img/icons/favicon-16x16.png" sizes="16x16">
    <meta name="msapplication-TileColor" content="#00a300">
    <meta name="msapplication-TileImage" content="./img/icons/mstile-144x144.png">
    <meta name="msapplication-square70x70logo" content="./img/icons/mstile-70x70.png">
    <meta name="msapplication-square144x144logo" content="./img/icons/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="./img/icons/mstile-150x150.png">
    <meta name="msapplication-square310x310logo" content="./img/icons/mstile-310x310.png">
    <meta name="msapplication-wide310x150logo" content="./img/icons/mstile-310x150.png">
    <!-- End of icon stuff -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Welcome to Lúmë Ardaron, the site of the elven reckoning." />
    <meta name="keywords" content="lume, ardaron, arda, time, reckoning, tolkien, elven, elvish, elf, silmarillion, quenya, sindarin, tengwar, shire, hobbit, lord, rings, rivendell, imladris, lorien, king, ring, gondor, arnor, numenor, age, calendar, date, elven reckoning, elven tongue, ardalambion, Giancarlo, Mariot, uk" />
    <meta name="author" content="Giancarlo Mariot"
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="google" content="notranslate" />
    <link rel="shortcut icon" href="./img/favicon.png">
    <title>Lúmë Ardaron - The time of Arda- References</title>

    <!-- Bootstrap core CSS -->
    <link rel='stylesheet' href='css/bootstrap.min.css'>

    <!-- Custom styles for this template -->
    <link rel='stylesheet' href='css/sticky-footer-navbar.css'>

    <!-- Tengwar fonts -->
    <link rel='stylesheet' href='css/tengwar.css'>

    <!-- Main style -->
    <link rel='stylesheet' href='css/main.css'>

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Wrap all page content here -->
    <div id="wrap">

          <!-- Fixed navbar -->
      <nav class="navbar navbar-default navbar-static-top navbar-inverse" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand tengwar-regular tengwar-big" href="#">j~Mt$ `CuD7H5</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse">
          <p class="navbar-text">Reckoning:</p>
          <ul class="nav navbar-nav">
            <li><a href="rivendell-sindarin.html">Rivendell</a></li>
            <li><a href="king-sindarin.html">The King's</a></li>
            <!-- <li><a href="steward-sindarin.html">The Steward's</a></li> -->
            <li><a href="shire-english.html">Shire</a></li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">How it works <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="references.html">References</a></li>
                <li><a href="duodecimal.html">Duodecimal system</a></li>
                <!-- <li class='current'><a class='current' href="calculating.html">Calculating the date</a></li> -->
              </ul>
            </li>
          </ul>

        </div><!-- /.navbar-collapse -->
      </nav>

      <!-- Begin page content -->
      <div class="container">
        <div class="page-header hidden-xs">
          <h1>How the date is calculated</h1>
        </div>

        <h2>Introduction</h2>
        <p>
          In order to make the algorithm for the calculation of the elven date, I first got inspiration from <a href="references.html">two texts from the Internet which you can read with comments here</a>. I do not completely agree with them, but some key parts in these texts served as a very important basis for the whole logic.
        </p>
        <p>
          This page intends to serve as a reference for the logic used by the algorithms in this project. I assume the reader is already familiar with the way these calendars work, by either reading Tolkien material or the texts provided here. The content of this page is somewhat technical and I try to translate the logic into mathematical reasoning.
        </p>

        <h2>Calculating the date</h2>

        <h3>Terminology</h3>
        <p>
          It is important to review quickly the terminology used in this project.
        </p>

        <ul>
          <li>One solar year in quenya is called "loa", plural "loar";</li>
          <li>One elven "year" is actually equivalent to an average of 144 years, and is called, in quenya, "yén", plural "yéni";</li>
          <li>There an equivalent notion to bissextile year in the elven reckoning that occurs every 12 years, but since the term "bissextile" sounds out of context, I call it a "leap loa" instead;</li>
          <li>Sometimes, in this project, a period of time is expected to contain <em>leap days</em> within by default. If an exception arise, I use the term "no leap" or "non leap" to differentiate from the original concept;</li>
          <li>All elvish terms are used in quenya language.</li>
        </ul>

        <h3>Calendar's rules</h3>
        <p>A few rules are taken from the material available:</p>

        <ol>
          <li>One "normal" loa has 365 days</li>
          <li>One leap loa has 368 days, given that 365 are the normal days and 3 are leap days</li>
          <li>The loa is leap every 12 loar</li>
          <li>144 loar result in 1 yén</li>
          <li>The last loa of every 3rd yén is <strong>not</strong> a leap loa</li>
        </ol>

        <h3>Assumptions</h3>

        <p>A few assumptions also must take place:</p>

        <ol>
          <li>The reckoning must start as closest as possible with the Gregorian calendar</li>
          <li>The first day of winter must match the 21st of November of the year 1</li>
          <li>The offset of the last rule must be applied, pushing the first day of the first loa to 29th of March, year 1</li>
          <li>No other adjustments other than the ones expected in the rules above must be made</li>
        </ol>

        <h3>Method of calculation</h3>

        <p>The current time will be calculated in the following manner:</p>

        <ol>
          <li>The 1st of January of the year 1 (Gregorian day 1) will be calculated using the Gregorian calendar (it is assumed that any innacuracies were dealt with in this reckoning)</li>
          <li>The current date is the sum of all days since Gregorian day 1 minus the offset of the first year/loa (day 1)</li>
          <li>All loar will be grouped in clusters of 12, designated "leap cycle" or, for short, "cycle"</li>
          <li>All yéni will be the result of a cluster of 12 cycles</li>
          <li>All yéni will be grouped in clusters of 3 designated "yéni group period", or, for short, "period", in which there will be 3 days removed to follow rule #5</li>
        </ol>

        <h3>Constant values</h3>

        <p>From this point, we can calculate a few constant values to be used in the whole logic:</p>

        <dl class="dl-horizontal">
           <dt>normal.loa      </dt><dd><span class="label label-success">365</span></dd>
           <dt>leap.period     </dt><dd><span class="label label-success">3  </span></dd>
           <dt>leap.loa        </dt><dd><span class="label label-default">normal.loa + leap.period         </span> = <span class="label label-warning">365 + 3            </span> = <span class="label label-success">368</span></dd>
           <dt>normal.cycle    </dt><dd><span class="label label-default">loa × 11 + leap.loa              </span> = <span class="label label-warning">365 × 11 + 368     </span> = <span class="label label-success">4,383</span></dd>
           <dt>no.leap.cycle   </dt><dd><span class="label label-default">loa × 12                         </span> = <span class="label label-warning">365 × 12           </span> = <span class="label label-success">4,380</span></dd>
           <dt>normal.yén      </dt><dd><span class="label label-default">cycle × 12                       </span> = <span class="label label-warning">4,383 × 12         </span> = <span class="label label-success">13,149</span></dd>
           <dt>no.leap.yén     </dt><dd><span class="label label-default">normal.cycle × 11 + no.leap.cycle</span> = <span class="label label-warning">4,383 × 11 + 4,380 </span> = <span class="label label-success">13,146</span></dd>
           <dt>period          </dt><dd><span class="label label-default">normal.yén × 2 + no.leap.yén     </span> = <span class="label label-warning">13,149 × 2 + 13,146</span> = <span class="label label-success">39,444</span></dd>
        </dl>

        <h3>Absolute date</h3>
        <p>
          Before assembling the elven calendar, we must count how many days passed since the beginning of the Gregorian reckoning.
        </p>
        <p>
          Assuming the Gregorian reckoning fixes the Julian calendar deficiencies and the year 1 of this counting is in effect the first year of the common era, we sum up all days passed since the beginning of the reckoning until the last day of the previous year. Then we calculate how many days passed in the current Gregorian year.
        </p>
        <p>
          To count a period of days (upper-case delta) passed from year 1 CE to last year, we must sum up all standard 365 days of every year with the leap days:
        </p>
        <p class="text-center">
          <img src="./img/gregorianAbsoluteDay.svg" alt="DL = 365*(y-1)+floor((y-1)/4)-floor((y-1)/100)-floor((y-1)/400)+dl" />
        </p>
        <p>
          And to count the days passed in the current year (lower-case delta) we can use this equation (<strong>y</strong> is the year, <strong>m</strong> is the month and <strong>d</strong> is the day of the month):
        </p>
        <p class="text-center">
          <img src="./img/gregorianDayOfYear.svg" alt="dl = [floor(30.6*(m+9)%12)+58.5+d]%365" />
        </p>
        <p>
          As the reader may notice, the last equation won't work for leap years, in which we must apply an adjustment of one extra day if the date follows the 29th of February.
        </p>

      </div>
    </div>

    <div id="footer">
      <div class="container">
        <p class="text-muted">
          Copyright &copy; 2014 Giancarlo Mariot. All rights reserved.
        </p>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
  </body>
</html>