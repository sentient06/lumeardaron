<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Welcome to Lúmë Ardaron, the site of the elven reckoning." />
    <meta name="keywords" content="lume, ardaron, arda, time, reckoning, tolkien, elven, elvish, elf, silmarillion, quenya, sindarin, tengwar, shire, hobbit, lord, rings, rivendell, imladris, lorien, king, ring, gondor, arnor, numenor, age, calendar, date, elven reckoning, elven tongue, ardalambion, Giancarlo, Mariot, uk" />
    <meta name="author" content="Giancarlo Mariot"
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="google" content="notranslate" />
    <link rel="shortcut icon" href="./img/favicon.png">

    <title>Lúmë Ardaron - The time of Arda</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="./css/sticky-footer-navbar.css" rel="stylesheet">

    <!-- Tengwar fonts -->
    <link href="./css/tengwar.css" rel="stylesheet">

    <!-- Main style -->
    <link href="./css/main.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
        var today      = new Date();
        var todayDay   = today.getUTCDate();
        var todayMonth = today.getUTCMonth() + 1;
        var todayYear  = today.getUTCFullYear();
    </script>
    <script src="./js/calendar.js"></script>
    <script src="./js/sindarin.js"></script>

  </head>

  <body>

    <!-- Wrap all page content here -->
    <div id="wrap">

      <!-- Fixed navbar -->
      <div class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand tengwar-regular tengwar-big" href="#">j~Mt$ `CuD7H5</a>
          </div>
          <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
              <li class="dropdown active">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Current date <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="active"><a href="rivendell-sindarin.html">Rivendell reckoning</a></li>
                  <!-- <li><a href="#">The King's reckoning</a></li> -->
                  <!-- <li><a href="#">The Steward's reckoning</a></li> -->
                  <!-- <li><a href="#">Shire reckoning</a></li> -->
                  <!-- <li class="divider"></li> -->
                  <!-- <li class="dropdown-header">Nav header</li> -->
                  <!-- <li><a href="#">Separated link</a></li> -->
                </ul>
              </li>

              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">How it works <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="duodecimal.html">Duodecimal system</a></li>
                </ul>
              </li>

            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <!-- Begin page content -->
      <div class="container">
        <div class="page-header hidden-xs">
          <h1>How is the date calculated</h1>
        </div>

        <h3>Introduction</h3>
        <p>
          In order to make the algorithm for the calculation of the elven date, I first got inspiration from two texts from the Internet which you can read with comments here. I do not completely agree with them, but they served as a very important basis for the whole logic.
        </p>
        <p>
          Assuming the reader is already familiar with the way these calendars work, by either reading Tolkien material or the texts provided here, I want to further discuss the logic used in this project.
        </p>

        <h3>Rules</h3>
        <p>A few rules are taken from the material available:</p>

        <ol>
          <li>One "normal" loa has 365 days</li>
          <li>One leap loa has 368 days</li>
          <li>The loa is leap every 12 loar</li>
          <li>144 loar result in 1 yén</li>
          <li>The last loa of every 3rd yén is not a leap loa</li>
        </ol>

        <h3>Assumptions</h3>

        <p>A few assumptions also take place:</p>

        <ol>
          <li>The reckoning must start as closest as possible with the Gregorian calendar</li>
          <li>The first day of winter must match the 21st of November of the year 1</li>
          <li>The offset of the last rule must be applied, pushing the first day of the first loa to 29th of March, year 1</li>
          <li>No other adjustements other than the ones expected in the rules above must be made</li>
        </ol>

        <h3>Method of calculation</h3>

        <p>The current time will be calculated in the following manner:</p>

        <ol>
          <li>The 1st of January of the year 1 (gregorian day 1) will be calculated using the Gregorian calendar (it is assumed that any innacuracies were dealt with in this reckoning)</li>
          <li>The current date is the sum of all days since gregorian day 1 minus the offset of the first year/loa (day 1)</li>
          <li>All loar will be grouped in clusters of 12, designated "leap cycle" or, for short, "cycle"</li>
          <li>All yéni will be the result of a cluster of 12 cycles</li>
          <li>All yéni will be grouped in clusters of 3 designated "yeni group period", or, for short, "period", in which there will be 3 days removed to follow rule #5</li>
        </ol>

        <h3>Values</h3>

        <p>From this point, we can calculate a few constant values to be used in the whole logic:</p>

        <dl class="dl-horizontal">
           <dt>loa             </dt><dd><span class="label label-success">365</span></dd>
           <dt>leap.period     </dt><dd><span class="label label-success">3  </span></dd>
           <dt>leap.loa        </dt><dd><span class="label label-default">loa + leap.period                </span> = <span class="label label-warning">365 + 3            </span> = <span class="label label-success">368</span></dd>
           <dt>normal.cycle    </dt><dd><span class="label label-default">loa × 11 + leap.loa              </span> = <span class="label label-warning">365 × 11 + 368     </span> = <span class="label label-success">4,383</span></dd>
           <dt>no.leap.cycle   </dt><dd><span class="label label-default">loa × 12                         </span> = <span class="label label-warning">365 × 12           </span> = <span class="label label-success">4,380</span></dd>
           <dt>normal.yén      </dt><dd><span class="label label-default">cycle × 12                       </span> = <span class="label label-warning">4,383 × 12         </span> = <span class="label label-success">13,149</span></dd>
           <dt>no.leap.yén     </dt><dd><span class="label label-default">normal.cycle × 11 + no.leap.cycle</span> = <span class="label label-warning">4,383 × 11 + 4,380 </span> = <span class="label label-success">13,146</span></dd>
           <dt>period          </dt><dd><span class="label label-default">normal.yén × 2 + no.leap.yén     </span> = <span class="label label-warning">13,149 × 2 + 13,146</span> = <span class="label label-success">39,444</span></dd>
        </dl>

        <h3>Absolute date</h3>

        <p>Before assembling the elven calendar, we must count how many days passed since the beginning of the Gregorian reckoning.</p>
        <p>Assuming the Gregorian reckoning fixes the Julian calendar deficiencies and the year 1 of this counting is in effect the first year of the common era, we sum up all days passed since the beginning of the reckoning until the last day of the previous year. Then we calculate how many days passed in the current gregorian year.</p>
        <p>To count the days passed in the current year we can use this equation:</p>
        <p class="text-center">
          <img src="./img/gregorianDayOfYear.png" alt="dl = [floor(30.6*(m+9)%12)+58.5+d]%365" />
        </p>
        <p>To count the days passed since year 1, we can use this:</p>
        <p class="text-center">
          <img src="./img/gregorianAbsoluteDay.png" alt="DL = 365*(y-1)+floor((y-1)/4)-floor((y-1)/100)-floor((y-1)/400)+dl" />
        </p>

      </div>
    </div>

    <div id="footer">
      <div class="container">
        <p class="text-muted">
          Copyright &copy; 2014 Giancarlo Mariot. All rights reserved.
        </p>
      </div>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
  </body>
</html>